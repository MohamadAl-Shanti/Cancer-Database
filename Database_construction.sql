-- Section 1: Database construction

-- Creates the Cancer_database database
DROP DATABASE IF EXISTS Cancer_database;
CREATE DATABASE Cancer_database;
USE Cancer_database;

-- Creates the Cancers table which holds information about different kinds of cancer
DROP TABLE IF EXISTS Cancers;
CREATE TABLE Cancers (
    Cancer_name VARCHAR(100) PRIMARY KEY,
    Cancer_group VARCHAR(100)
    );

-- Creates the Country table which holds information about countries
DROP TABLE IF EXISTS Country;
CREATE TABLE Country (
    Country_ID VARCHAR(100) PRIMARY KEY,
    Country_name VARCHAR(100)
    );

-- Creates the Deaths_per_year table which keeps track of the total yearly sum cancer related deaths
DROP TABLE IF EXISTS Deaths_per_year;
CREATE TABLE Deaths_per_year (
    Year_number INT PRIMARY KEY,
    Death_count INT CHECK (Death_count >= 0)
    );

/*
 Creates the Deaths_per_country table which tracks sum of deaths 
 caused by each cancer type in each country over the time period
 in question.
 */
DROP TABLE IF EXISTS Deaths_per_country;
CREATE TABLE Deaths_per_country (
    Country_ID VARCHAR(100),
    Cancer_name VARCHAR(100),
    Death_count INT CHECK (Death_count >= 0),
    PRIMARY KEY (Country_ID, Cancer_name),
    FOREIGN KEY (Country_ID) REFERENCES Country(Country_ID),
    FOREIGN KEY (Cancer_name) REFERENCES Cancers(Cancer_name)
    );
    
/*
 Creates the Fossil_fuel_emissions table which tracks the amount of
 fossil fuel emission amount in each country in gigatons over the 
 time period in question.
*/    
DROP TABLE IF EXISTS Fossil_fuel_emissions;    
CREATE TABLE Fossil_fuel_emissions (
    Year_number INT CHECK (Year_number >= 0),
    Country_ID VARCHAR(100), 
    Emission_value INT CHECK (Emission_value >= 0),
    PRIMARY KEY (Year_number, Country_ID),
    FOREIGN KEY (Year_number) REFERENCES Deaths_per_year(Year_number),
    FOREIGN KEY (Country_ID) REFERENCES Country(Country_ID)
    );

-- Inserts rows into Cancers
INSERT INTO Cancers (Cancer_name, Cancer_group)
    VALUES 
       	('liver cancer', 'Digestive System'),
	    ('kidney cancer', 'Urinary System'),
		('larynx cancer', 'Respiratory System'),
		('breast cancer', 'Reproductive System'),
		('thyroid cancer', 'Endocrine System'),
		('stomach cancer', 'Digestive System'),
		('bladder cancer', 'Urinary System'),
		('uterine cancer', 'Reproductive System'),
		('ovarian cancer', 'Reproductive System'),
		('cervical cancer', 'Reproductive System'),
		('prostate cancer', 'Reproductive System'),
		('pancreatic cancer', 'Digestive System'),
		('esophageal cancer', 'Digestive System'),
		('testicular cancer', 'Reproductive System'),
		('nasopharynx cancer', 'Respiratory System'),
		('other pharynx cancer', 'Respiratory System'),
		('colon and rectum cancer', 'Digestive System'),
		('non-melanoma skin cancer', 'Integumentary System'),
		('lip and oral cavity cancer', 'Head and Neck'),
		('brain and nervous system cancer', 'Nervous System'),
		('tracheal, bronchus, and lung cancer', 'Respiratory System'),
		('gallbladder and biliary tract cancer', 'Digestive System'),
		('malignant skin melanoma', 'Integumentary System'),
		('leukemia', 'Hematologic System'),
		('Hodgkin lymphoma', 'Hematologic System'),
		('multiple myeloma', 'Hematologic System'),
		('other cancers', 'Other');

-- Inserts the 6 countries being analyzed in this database into Country
INSERT INTO Country (Country_id, Country_name)
VALUES
	('CHN', 'China'),
    ('ETH', 'Ethiopia'),
    ('BRA', 'Brazil'),
    ('DEU', 'Germany'),
    ('AUS', 'Australia'),
    ('USA', 'United States');

-- Inserts rows into Deaths_per_year
INSERT INTO Deaths_per_year (Year_number, Death_count)
VALUES
  (1990, 3702456),
  (1991, 3598123),
  (1992, 3932167),
  (1993, 3789345),
  (1994, 3856709),
  (1995, 5593977),
  (1996, 3775177),
  (1997, 3845526),
  (1998, 3929746),
  (1999, 4021474),
  (2000, 4107710),
  (2001, 4212175),
  (2002, 4333195),
  (2003, 4309711),
  (2004, 4418235),
  (2005, 4462455),
  (2006, 4548786),
  (2007, 4661920),
  (2008, 4722599),
  (2009, 4809392),
  (2010, 4911607),
  (2011, 5013664),
  (2012, 5076953),
  (2013, 5180335),
  (2014, 5272846),
  (2015, 5384832),
  (2016, 5492787);

-- Inserts rows into Deaths_per_country
INSERT INTO Deaths_per_country (Country_ID, Cancer_name, Death_count)
VALUES
  ('CHN', 'Liver cancer', 9672835.6446),
  ('CHN', 'Kidney cancer', 387220.7419),
  ('CHN', 'Larynx cancer', 6944245.309),
  ('CHN', 'Breast cancer', 216922.5946),
  ('CHN', 'Thyroid cancer', 6806276.890),
  ('CHN', 'Stomach cancer', 9226166.409),
  ('CHN', 'Bladder cancer', 2618876.431),
  ('CHN', 'Uterine cancer', 2025983.768),
  ('CHN', 'Ovarian cancer', 1090331.428),
  ('CHN', 'Cervical cancer', 6509873.307),
  ('CHN', 'Prostate cancer', 1497161.354),
  ('CHN', 'Pancreatic cancer', 12688160.114),
  ('CHN', 'Esophageal cancer', 42043838.392),
  ('CHN', 'Testicular cancer', 25372.23216),
  ('CHN', 'Nasopharynx cancer', 2342870.457),
  ('CHN', 'Other pharynx cancer', 76174.47452),
  ('CHN', 'Colon and rectum cancer', 2980978.765),
  ('CHN', 'Non-melanoma skin cancer', 2934168.526),
  ('CHN', 'Lip and oral cavity cancer', 3017767.188),
  ('CHN', 'Brain and nervous system cancer', 105623308.7),
  ('CHN', 'Tracheal, bronchus, and lung cancer', 4604046.664),
  ('CHN', 'Gallbladder and biliary tract cancer', 1319183.776),
  ('CHN', 'Malignant skin melanoma', 59133.16843),
  ('CHN', 'Leukemia', 1775364.284),
  ('CHN', 'Hodgkin lymphoma', 599151.7233),
  ('CHN', 'Multiple myeloma', 315207.2303),
  ('CHN', 'Other cancers', 6297923.042),
  ('USA', 'Liver cancer', 248591.92829),
  ('USA', 'Kidney cancer', 163244.388189),
  ('USA', 'Larynx cancer', 5047.339271),
  ('USA', 'Breast cancer', 49327.20651), 
  ('USA', 'Thyroid cancer', 1988.665863),
  ('USA', 'Stomach cancer', 17129.87483),
  ('USA', 'Bladder cancer', 18386.87994),
  ('USA', 'Uterine cancer', 7855.707633),
  ('USA', 'Ovarian cancer', 16680.76158),
  ('USA', 'Cervical cancer', 6835.489211),
  ('USA', 'Prostate cancer', 35467.5465),
  ('USA', 'Pancreatic cancer', 46252.84399),
  ('USA', 'Esophageal cancer', 18140.76735),
  ('USA', 'Testicular cancer', 426.8619077),
  ('USA', 'Nasopharynx cancer', 1083.115066),
  ('USA', 'Other pharynx cancer', 3539.815613),
  ('USA', 'Colon and rectum cancer', 79296.79697),
  ('USA', 'Non-melanoma skin cancer', 3562.020258),
  ('USA', 'Lip and oral cavity cancer', 6752.275017),
  ('USA', 'Brain and nervous system cancer', 16778.63758),
  ('USA', 'Tracheal, bronchus, and lung cancer', 191461.9919),
  ('USA', 'Gallbladder and biliary tract cancer', 4362.648652),
  ('USA', 'Malignant skin melanoma', 10478.78752),
  ('USA', 'Leukemia', 28852.14278),
  ('USA', 'Hodgkin lymphoma', 1325.017596),
  ('USA', 'Multiple myeloma', 14212.36133),
  ('USA', 'Other cancers', 28632.72799),
  ('BRA', 'Liver cancer', 162966.38301),
  ('BRA', 'Kidney cancer', 51538.28169),
  ('BRA', 'Larynx cancer', 1244.167468),
  ('BRA', 'Breast cancer', 510828.537),
  ('BRA', 'Thyroid cancer', 30087.8277),
  ('BRA', 'Stomach cancer', 111376.4772),
  ('BRA', 'Bladder cancer', 16196.18901),
  ('BRA', 'Uterine cancer', 41268.5708),
  ('BRA', 'Ovarian cancer', 195328.6475),
  ('BRA', 'Cervical cancer', 52671.70825),
  ('BRA', 'Prostate cancer', 123328.0552),
  ('BRA', 'Pancreatic cancer', 173581.0411),
  ('BRA', 'Esophageal cancer', 73110.99268),
  ('BRA', 'Testicular cancer', 2772.956037),
  ('BRA', 'Nasopharynx cancer', 4169.87899),
  ('BRA', 'Other pharynx cancer', 26758.46499),
  ('BRA', 'Colon and rectum cancer', 635823.1239),
  ('BRA', 'Non-melanoma skin cancer', 6223.593231),
  ('BRA', 'Lip and oral cavity cancer', 47847.34419),
  ('BRA', 'Brain and nervous system cancer', 52650.87569),
  ('BRA', 'Tracheal, bronchus, and lung cancer', 657833.2263),
  ('BRA', 'Gallbladder and biliary tract cancer', 18591.4793),
  ('BRA', 'Malignant skin melanoma', 25571.32934),
  ('BRA', 'Leukemia', 96149.6177),
  ('BRA', 'Hodgkin lymphoma', 4721.756299),
  ('BRA', 'Multiple myeloma', 43749.30671),
  ('BRA', 'Other cancers', 134634.3277),
  ('DEU', 'Liver cancer', 63394.33863),
  ('DEU', 'Kidney cancer', 12606.605),
  ('DEU', 'Larynx cancer', 3784.939938),
  ('DEU', 'Breast cancer', 238905.7597), 
  ('DEU', 'Thyroid cancer', 2819.976944),
  ('DEU', 'Stomach cancer', 44665.97852),
  ('DEU', 'Bladder cancer', 48140.45424),
  ('DEU', 'Uterine cancer', 15154.11299),
  ('DEU', 'Ovarian cancer', 20408.87805),
  ('DEU', 'Cervical cancer', 7923.938117),
  ('DEU', 'Prostate cancer', 106176.1321),
  ('DEU', 'Pancreatic cancer', 80665.52594),
  ('DEU', 'Esophageal cancer', 34402.29709),
  ('DEU', 'Testicular cancer', 3502.541606),
  ('DEU', 'Nasopharynx cancer', 3822.97716),
  ('DEU', 'Other pharynx cancer', 2351.495269),
  ('DEU', 'Colon and rectum cancer', 200786.9202),
  ('DEU', 'Non-melanoma skin cancer', 124395.6127),
  ('DEU', 'Lip and oral cavity cancer', 9363.713513),
  ('DEU', 'Brain and nervous system cancer', 29652.908),
  ('DEU', 'Tracheal, bronchus, and lung cancer', 312229.6431),
  ('DEU', 'Gallbladder and biliary tract cancer', 18572.57434),
  ('DEU', 'Malignant skin melanoma', 12126.99874),
  ('DEU', 'Leukemia', 45872.34297),
  ('DEU', 'Hodgkin lymphoma', 2734.735754),
  ('DEU', 'Multiple myeloma', 23212.29046),
  ('DEU', 'Other cancers', 190642.4096),
  ('AUS', 'Liver cancer', 24618.44073),
  ('AUS', 'Kidney cancer', 3881.046903),
  ('AUS', 'Larynx cancer', 1277.128218),
  ('AUS', 'Breast cancer', 130740.778),
  ('AUS', 'Thyroid cancer', 2288.184342),
  ('AUS', 'Stomach cancer', 33984.40194),
  ('AUS', 'Bladder cancer', 36539.52922),
  ('AUS', 'Uterine cancer', 11024.26743),
  ('AUS', 'Ovarian cancer', 13797.26659),
  ('AUS', 'Cervical cancer', 5680.379094),
  ('AUS', 'Prostate cancer', 79462.82832),
  ('AUS', 'Pancreatic cancer', 58765.93835),
  ('AUS', 'Esophageal cancer', 30057.81017),
  ('AUS', 'Testicular cancer', 2891.303234),
  ('AUS', 'Nasopharynx cancer', 2921.244268),
  ('AUS', 'Other pharynx cancer', 1828.497265),
  ('AUS', 'Colon and rectum cancer', 155529.2422),
  ('AUS', 'Non-melanoma skin cancer', 97107.74437),
  ('AUS', 'Lip and oral cavity cancer', 7423.465893),
  ('AUS', 'Brain and nervous system cancer', 23547.00413),
  ('AUS', 'Tracheal, bronchus, and lung cancer', 251839.9522),
  ('AUS', 'Gallbladder and biliary tract cancer', 15277.54013),
  ('AUS', 'Malignant skin melanoma', 9869.588844),
  ('AUS', 'Leukemia', 39783.6023),
  ('AUS', 'Hodgkin lymphoma', 2430.979554),
  ('AUS', 'Multiple myeloma', 20721.31124),
  ('AUS', 'Other cancers', 170340.127),
  ('ETH', 'Liver cancer', 56124.44823),
  ('ETH', 'Kidney cancer', 9262.437004),
  ('ETH', 'Larynx cancer', 2654.065384),
  ('ETH', 'Breast cancer', 178578.2832),
  ('ETH', 'Thyroid cancer', 3266.160616),
  ('ETH', 'Stomach cancer', 57504.83124),
  ('ETH', 'Bladder cancer', 65621.46142),
  ('ETH', 'Uterine cancer', 16846.80931),
  ('ETH', 'Ovarian cancer', 21176.85655),
  ('ETH', 'Cervical cancer', 9631.888064),
  ('ETH', 'Prostate cancer', 124019.9641),
  ('ETH', 'Pancreatic cancer', 101114.0752),
  ('ETH', 'Esophageal cancer', 56882.33402),
  ('ETH', 'Testicular cancer', 5563.165094),
  ('ETH', 'Nasopharynx cancer', 5372.197446),
  ('ETH', 'Other pharynx cancer', 3334.118268),
  ('ETH', 'Colon and rectum cancer', 310055.7641),
  ('ETH', 'Non-melanoma skin cancer', 200493.646),
  ('ETH', 'Lip and oral cavity cancer', 14419.10674),
  ('ETH', 'Brain and nervous system cancer', 46661.50207),
  ('ETH', 'Tracheal, bronchus, and lung cancer', 487155.4865),
  ('ETH', 'Gallbladder and biliary tract cancer', 28042.68965),
  ('ETH', 'Malignant skin melanoma', 18523.34158),
  ('ETH', 'Leukemia', 75153.62461),
  ('ETH', 'Hodgkin lymphoma', 4773.077564),
  ('ETH', 'Multiple myeloma', 39045.59254),
  ('ETH', 'Other cancers', 320647.2087);

-- Inserts rows into Fossil_fuel_emissions
INSERT INTO Fossil_fuel_emissions (Year_number, Country_ID, Emission_value)
VALUES
	(1990, 'CHN', 22.1),
	(1991, 'CHN', 22.3),
	(1992, 'CHN', 22.7),
	(1993, 'CHN', 23.0),
	(1994, 'CHN', 23.5),
	(1995, 'CHN', 24.0),
	(1996, 'CHN', 24.5),
	(1997, 'CHN', 24.8),
	(1998, 'CHN', 25.0),
	(1999, 'CHN', 25.3),
	(2000, 'CHN', 25.7),
	(2001, 'CHN', 26.1),
	(2002, 'CHN', 26.5),
	(2003, 'CHN', 27.0),
	(2004, 'CHN', 27.5),
	(2005, 'CHN', 28.0),
	(2006, 'CHN', 28.5),
	(2007, 'CHN', 29.0),
	(2008, 'CHN', 29.4),
	(2009, 'CHN', 29.7),
	(2010, 'CHN', 30.2),
	(2011, 'CHN', 30.7),
	(2012, 'CHN', 31.1),
	(2013, 'CHN', 31.5),
	(2014, 'CHN', 31.8),
	(2015, 'CHN', 32.0),
	(2016, 'CHN', 32.5),
	(1990, 'USA', 20.5),
	(1991, 'USA', 21.0),
	(1992, 'USA', 21.3),
	(1993, 'USA', 21.8),
	(1994, 'USA', 22.2),
	(1995, 'USA', 22.7),
	(1996, 'USA', 23.0),
	(1997, 'USA', 23.5),
	(1998, 'USA', 23.8),
	(1999, 'USA', 24.2),
	(2000, 'USA', 24.7),
	(2001, 'USA', 25.1),
	(2002, 'USA', 25.5),
	(2003, 'USA', 26.0),
	(2004, 'USA', 26.5),
	(2005, 'USA', 26.9),
	(2006, 'USA', 27.3),
	(2007, 'USA', 27.8),
	(2008, 'USA', 28.2),
	(2009, 'USA', 28.6),
	(2010, 'USA', 29.0),
	(2011, 'USA', 29.5),
	(2012, 'USA', 29.9),
	(2013, 'USA', 30.3),
	(2014, 'USA', 30.7),
	(2015, 'USA', 31.1),
	(2016, 'USA', 31.5),
	(1990, 'BRA', 15.2),
	(1991, 'BRA', 15.7),
	(1992, 'BRA', 16.1),
	(1993, 'BRA', 16.5),
	(1994, 'BRA', 17.0),
	(1995, 'BRA', 17.4),
	(1996, 'BRA', 17.9),
	(1997, 'BRA', 18.3),
	(1998, 'BRA', 18.7),
	(1999, 'BRA', 19.1),
	(2000, 'BRA', 19.5),
	(2001, 'BRA', 20.0),
	(2002, 'BRA', 20.5),
	(2003, 'BRA', 20.9),
	(2004, 'BRA', 21.3),
	(2005, 'BRA', 21.7),
	(2006, 'BRA', 22.1),
	(2007, 'BRA', 22.5),
	(2008, 'BRA', 22.9),
	(2009, 'BRA', 23.3),
	(2010, 'BRA', 23.7),
	(2011, 'BRA', 24.1),
	(2012, 'BRA', 24.5),
	(2013, 'BRA', 24.9),
	(2014, 'BRA', 25.3),
	(2015, 'BRA', 25.7),
	(2016, 'BRA', 26.1),
	(1990, 'DEU', 18.5),
	(1991, 'DEU', 19.0),
	(1992, 'DEU', 19.5),
	(1993, 'DEU', 20.0),
	(1994, 'DEU', 20.5),
	(1995, 'DEU', 21.0),
	(1996, 'DEU', 21.5),
	(1997, 'DEU', 22.0),
	(1998, 'DEU', 22.5),
	(1999, 'DEU', 23.0),
	(2000, 'DEU', 23.5),
	(2001, 'DEU', 24.0),
	(2002, 'DEU', 24.5),
	(2003, 'DEU', 25.0),
	(2004, 'DEU', 25.5),
	(2005, 'DEU', 26.0),
	(2006, 'DEU', 26.5),
	(2007, 'DEU', 27.0),
	(2008, 'DEU', 27.5),
	(2009, 'DEU', 28.0),
	(2010, 'DEU', 28.5),
	(2011, 'DEU', 29.0),
	(2012, 'DEU', 29.5),
	(2013, 'DEU', 30.0),
	(2014, 'DEU', 30.5),
	(2015, 'DEU', 30.9),
	(2016, 'DEU', 31.3),
	(1990, 'AUS', 25.5),
	(1991, 'AUS', 26.0),
	(1992, 'AUS', 26.5),
	(1993, 'AUS', 27.0),
	(1994, 'AUS', 27.5),
	(1995, 'AUS', 28.0),
	(1996, 'AUS', 28.5),
	(1997, 'AUS', 29.0),
	(1998, 'AUS', 29.5),
	(1999, 'AUS', 30.0),
	(2000, 'AUS', 30.5),
	(2001, 'AUS', 31.0),
	(2002, 'AUS', 31.5),
	(2003, 'AUS', 32.0),
	(2004, 'AUS', 32.5),
	(2005, 'AUS', 32.9),
	(2006, 'AUS', 33.3),
	(2007, 'AUS', 33.7),
	(2008, 'AUS', 34.1),
	(2009, 'AUS', 34.5),
	(2010, 'AUS', 34.9),
	(2011, 'AUS', 35.3),
	(2012, 'AUS', 35.7),
	(2013, 'AUS', 36.1),
	(2014, 'AUS', 36.5),
	(2015, 'AUS', 36.9),
	(2016, 'AUS', 37.3),
	(1990, 'ETH', 7.5),
	(1991, 'ETH', 8.0),
	(1992, 'ETH', 8.5),
	(1993, 'ETH', 9.0),
	(1994, 'ETH', 9.5),
	(1995, 'ETH', 10.0),
	(1996, 'ETH', 10.5),
	(1997, 'ETH', 11.0),
	(1998, 'ETH', 11.5),
	(1999, 'ETH', 12.0),
	(2000, 'ETH', 12.5),
	(2001, 'ETH', 13.0),
	(2002, 'ETH', 13.5),
	(2003, 'ETH', 14.0),
	(2004, 'ETH', 14.5),
	(2005, 'ETH', 15.0),
	(2006, 'ETH', 15.5),
	(2007, 'ETH', 16.0),
	(2008, 'ETH', 16.5),
	(2009, 'ETH', 17.0),
	(2010, 'ETH', 17.5),
	(2011, 'ETH', 18.0),
	(2012, 'ETH', 18.5),
	(2013, 'ETH', 19.0),
	(2014, 'ETH', 19.5),
	(2015, 'ETH', 20.0),
	(2016, 'ETH', 20.5);